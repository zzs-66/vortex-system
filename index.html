<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>█ 暗物质数据舱 █</title>
    <style>
        :root {
            --虚空黑: #0a0a0a;
            --量子金: #d4af37;
            --星环纹: linear-gradient(45deg, 
                transparent 0%, 
                rgba(212,175,55,0.1) 50%, 
                transparent 100%
            );
        }

        body {
            background: var(--虚空黑);
            color: #d4af99;
            font-family: 'Noto Serif SC', serif;
            padding: 20px;
            min-height: 100vh;
        }

        .quantum-panel {
            max-width: 1200px;
            margin: 0 auto;
            border: 1px solid;
            border-image: linear-gradient(to right, #d4af3700, #d4af37, #d4af3700) 1;
            background: rgba(10,10,10,0.95);
        }

        .data-node {
            padding: 20px;
            margin: 20px 0;
            background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
            border-left: 4px solid var(--量子金);
            position: relative;
        }

        #quantumBtn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(90deg, #d4af37, #9c8412);
            border: none;
            color: #000;
            font-size: 1.2em;
            letter-spacing: 3px;
            clip-path: polygon(10% 0, 90% 0, 100% 50%, 90% 100%, 10% 100%, 0 50%);
        }
    </style>
</head>
<body>
    <div class="quantum-panel">
        <div class="data-node">
            <h3>◈ 量子核心 ◈</h3>
            <pre id="coreData">架构：加载中...</pre>
        </div>
        
        <div class="data-node">
            <h3>◈ 超弦信道 ◈</h3>
            <pre id="networkData">IP地址：█████</pre>
        </div>

        <button id="quantumBtn" onclick="activateQuantum()">激 活 量 子 隧 穿</button>
    </div>

    <script>
        // 终极配置（使用你提供的参数）
        const SUPABASE_URL = 'https://ptssgcagifrnlysakbpr.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB0c3NnY2FnaWZybmx5c2FrYnByIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU4NDM3NjIsImV4cCI6MjA2MTQxOTc2Mn0.2m7pv1bqhIKlWP0lsybtOK-eLfJCwvIr4CdE7oFViDc';

        // 超维度IP获取
        const getQuantumIP = async () => {
            const apis = [
                'https://api.ipify.org?format=json',
                'https://api64.ipify.org?format=json',
                'https://ifconfig.me/all.json'
            ];
            
            for (const api of apis) {
                try {
                    const res = await fetch(api);
                    const data = await res.json();
                    return data.ip || data.ip_addr;
                } catch {}
            }
            return '█ 量子屏蔽 █';
        };

        // 设备指纹重构（解决Win32问题）
        const getDeviceArch = () => {
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            return {
                type: isMobile ? 'Mobile' : 'Desktop',
                platform: isMobile ? 'MobileOS' : navigator.platform,
                cores: navigator.hardwareConcurrency
            };
        };

        // 黑洞级数据提交
        const quantumTunnel = async () => {
            const payload = {
                device_arch: getDeviceArch(),
                network_sigil: {
                    ip: await getQuantumIP()
                }
            };

            const res = await fetch(`${SUPABASE_URL}/rest/v1/vortex_scans`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_KEY,
                    'Authorization': `Bearer ${SUPABASE_KEY}`
                },
                body: JSON.stringify(payload)
            });
            return res.ok;
        };

        // 主协议
        const activateQuantum = async () => {
            const btn = document.getElementById('quantumBtn');
            btn.disabled = true;
            
            try {
                const arch = getDeviceArch();
                document.getElementById('coreData').textContent = 
                    `架构：${arch.type}\n平台：${arch.platform}\n核心：${arch.cores}`;

                const ip = await getQuantumIP();
                document.getElementById('networkData').textContent = `IP地址：${ip}`;

                if (await quantumTunnel()) {
                    alert('██ 量子共振完成 ██');
                }
            } catch {
                alert('██ 暗物质干扰 ██');
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
